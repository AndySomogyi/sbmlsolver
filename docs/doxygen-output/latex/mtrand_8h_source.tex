\hypertarget{mtrand_8h_source}{}\doxysection{mtrand.\+h}
\label{mtrand_8h_source}\index{c/mtrand.h@{c/mtrand.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// mtrand.h}}
\DoxyCodeLine{2 \textcolor{comment}{// C++ include file for MT19937, with initialization improved 2002/1/26.}}
\DoxyCodeLine{3 \textcolor{comment}{// Coded by Takuji Nishimura and Makoto Matsumoto.}}
\DoxyCodeLine{4 \textcolor{comment}{// Ported to C++ by Jasper Bedaux 2003/1/1 (see http://www.bedaux.net/mtrand/).}}
\DoxyCodeLine{5 \textcolor{comment}{// The generators returning floating point numbers are based on}}
\DoxyCodeLine{6 \textcolor{comment}{// a version by Isaku Wada, 2002/01/09}}
\DoxyCodeLine{7 \textcolor{comment}{//}}
\DoxyCodeLine{8 \textcolor{comment}{// Copyright (C) 1997 -\/ 2002, Makoto Matsumoto and Takuji Nishimura,}}
\DoxyCodeLine{9 \textcolor{comment}{// All rights reserved.}}
\DoxyCodeLine{10 \textcolor{comment}{//}}
\DoxyCodeLine{11 \textcolor{comment}{// Redistribution and use in source and binary forms, with or without}}
\DoxyCodeLine{12 \textcolor{comment}{// modification, are permitted provided that the following conditions}}
\DoxyCodeLine{13 \textcolor{comment}{// are met:}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{// 1. Redistributions of source code must retain the above copyright}}
\DoxyCodeLine{16 \textcolor{comment}{//    notice, this list of conditions and the following disclaimer.}}
\DoxyCodeLine{17 \textcolor{comment}{//}}
\DoxyCodeLine{18 \textcolor{comment}{// 2. Redistributions in binary form must reproduce the above copyright}}
\DoxyCodeLine{19 \textcolor{comment}{//    notice, this list of conditions and the following disclaimer in the}}
\DoxyCodeLine{20 \textcolor{comment}{//    documentation and/or other materials provided with the distribution.}}
\DoxyCodeLine{21 \textcolor{comment}{//}}
\DoxyCodeLine{22 \textcolor{comment}{// 3. The names of its contributors may not be used to endorse or promote}}
\DoxyCodeLine{23 \textcolor{comment}{//    products derived from this software without specific prior written}}
\DoxyCodeLine{24 \textcolor{comment}{//    permission.}}
\DoxyCodeLine{25 \textcolor{comment}{//}}
\DoxyCodeLine{26 \textcolor{comment}{// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}
\DoxyCodeLine{27 \textcolor{comment}{// "{}AS IS"{} AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT}}
\DoxyCodeLine{28 \textcolor{comment}{// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR}}
\DoxyCodeLine{29 \textcolor{comment}{// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR}}
\DoxyCodeLine{30 \textcolor{comment}{// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,}}
\DoxyCodeLine{31 \textcolor{comment}{// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,}}
\DoxyCodeLine{32 \textcolor{comment}{// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR}}
\DoxyCodeLine{33 \textcolor{comment}{// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF}}
\DoxyCodeLine{34 \textcolor{comment}{// LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING}}
\DoxyCodeLine{35 \textcolor{comment}{// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}}
\DoxyCodeLine{36 \textcolor{comment}{// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}}
\DoxyCodeLine{37 \textcolor{comment}{//}}
\DoxyCodeLine{38 \textcolor{comment}{// Any feedback is very welcome.}}
\DoxyCodeLine{39 \textcolor{comment}{// http://www.math.keio.ac.jp/matumoto/emt.html}}
\DoxyCodeLine{40 \textcolor{comment}{// email: matumoto@math.keio.ac.jp}}
\DoxyCodeLine{41 \textcolor{comment}{//}}
\DoxyCodeLine{42 \textcolor{comment}{// Feedback about the C++ port should be sent to Jasper Bedaux,}}
\DoxyCodeLine{43 \textcolor{comment}{// see http://www.bedaux.net/mtrand/ for e-\/mail address and info.}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{preprocessor}{\#ifndef MTRAND\_H}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#define MTRAND\_H}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{preprocessor}{\#include "{}rrExporter.h"{}}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{keyword}{class  }\mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}}
\DoxyCodeLine{51 \{ \textcolor{comment}{// Mersenne Twister random number generator}}
\DoxyCodeLine{52 \textcolor{keyword}{public}:}
\DoxyCodeLine{53 \textcolor{comment}{// default constructor: uses default seed only if this is the first instance}}
\DoxyCodeLine{54   \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}() \{ \textcolor{keywordflow}{if} (!init) seed(5489UL); init = \textcolor{keyword}{true}; \}}
\DoxyCodeLine{55 \textcolor{comment}{// constructor with 32 bit int as seed}}
\DoxyCodeLine{56   \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} s) \{ seed(s); init = \textcolor{keyword}{true}; \}}
\DoxyCodeLine{57 \textcolor{comment}{// constructor with array of size 32 bit ints as seed}}
\DoxyCodeLine{58   \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}* array, \textcolor{keywordtype}{int} size) \{ seed(array, size); init = \textcolor{keyword}{true}; \}}
\DoxyCodeLine{59 \textcolor{comment}{// the two seed functions}}
\DoxyCodeLine{60   \textcolor{keywordtype}{void} seed(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}); \textcolor{comment}{// seed with 32 bit integer}}
\DoxyCodeLine{61   \textcolor{keywordtype}{void} seed(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}*, \textcolor{keywordtype}{int} size); \textcolor{comment}{// seed with array}}
\DoxyCodeLine{62 \textcolor{comment}{// overload operator() to make this a generator (functor)}}
\DoxyCodeLine{63   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} operator()() \{ \textcolor{keywordflow}{return} rand\_int32(); \}}
\DoxyCodeLine{64 \textcolor{comment}{// 2007-\/02-\/11: made the destructor virtual; thanks "{}double more"{} for pointing this out}}
\DoxyCodeLine{65   \textcolor{keyword}{virtual} \mbox{\hyperlink{classMTRand__int32}{\string~MTRand\_int32}}() \{\} \textcolor{comment}{// destructor}}
\DoxyCodeLine{66 \textcolor{keyword}{protected}: \textcolor{comment}{// used by derived classes, otherwise not accessible; use the ()-\/operator}}
\DoxyCodeLine{67   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} rand\_int32() \textcolor{keyword}{const}; \textcolor{comment}{// generate 32 bit random integer}}
\DoxyCodeLine{68 \textcolor{keyword}{private}:}
\DoxyCodeLine{69   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} n;\textcolor{comment}{//}}
\DoxyCodeLine{70   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} m;\textcolor{comment}{//= 624, m = 397; // compile time constants}}
\DoxyCodeLine{71 \textcolor{comment}{// the variables below are static (no duplicates can exist)}}
\DoxyCodeLine{72   \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} state[]; \textcolor{comment}{// state std::vector array}}
\DoxyCodeLine{73   \textcolor{keyword}{static} \textcolor{keywordtype}{int} p; \textcolor{comment}{// position in state array}}
\DoxyCodeLine{74   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} init; \textcolor{comment}{// true if init function is called}}
\DoxyCodeLine{75 \textcolor{comment}{// private functions used to generate the pseudo random numbers}}
\DoxyCodeLine{76   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} twiddle(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}) \textcolor{keyword}{const}; \textcolor{comment}{// used by gen\_state()}}
\DoxyCodeLine{77   \textcolor{keywordtype}{void} gen\_state() \textcolor{keyword}{const}; \textcolor{comment}{// generate new state}}
\DoxyCodeLine{78 \textcolor{comment}{// make copy constructor and assignment operator unavailable, they don't make sense}}
\DoxyCodeLine{79   \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}\&); \textcolor{comment}{// copy constructor not defined}}
\DoxyCodeLine{80   \textcolor{keywordtype}{void} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}\&); \textcolor{comment}{// assignment operator not defined}}
\DoxyCodeLine{81 \};}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{comment}{// inline for speed, must therefore reside in header file}}
\DoxyCodeLine{84 \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} MTRand\_int32::twiddle(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} u, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{85   \textcolor{keywordflow}{return} (((u \& 0x80000000UL) | (v \& 0x7FFFFFFFUL)) >> 1)}
\DoxyCodeLine{86     \string^ ((v \& 1UL) ? 0x9908B0DFUL : 0x0UL);}
\DoxyCodeLine{87 \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} MTRand\_int32::rand\_int32()\textcolor{keyword}{ const }\{ \textcolor{comment}{// generate 32 bit random int}}
\DoxyCodeLine{90   \textcolor{keywordflow}{if} (p == n) gen\_state(); \textcolor{comment}{// new state std::vector needed}}
\DoxyCodeLine{91 \textcolor{comment}{// gen\_state() is split off to be non-\/inline, because it is only called once}}
\DoxyCodeLine{92 \textcolor{comment}{// in every 624 calls and otherwise irand() would become too big to get inlined}}
\DoxyCodeLine{93   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} x = state[p++];}
\DoxyCodeLine{94   x \string^= (x >> 11);}
\DoxyCodeLine{95   x \string^= (x << 7) \& 0x9D2C5680UL;}
\DoxyCodeLine{96   x \string^= (x << 15) \& 0xEFC60000UL;}
\DoxyCodeLine{97   \textcolor{keywordflow}{return} x \string^ (x >> 18);}
\DoxyCodeLine{98 \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100 \textcolor{comment}{// generates double floating point numbers in the half-\/open interval [0, 1)}}
\DoxyCodeLine{101 \textcolor{keyword}{class }\mbox{\hyperlink{classMTRand}{MTRand}} : \textcolor{keyword}{public} \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}} \{}
\DoxyCodeLine{102 \textcolor{keyword}{public}:}
\DoxyCodeLine{103   \mbox{\hyperlink{classMTRand}{MTRand}}() : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}() \{\}}
\DoxyCodeLine{104   \mbox{\hyperlink{classMTRand}{MTRand}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} seed) : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(seed) \{\}}
\DoxyCodeLine{105   \mbox{\hyperlink{classMTRand}{MTRand}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}* seed, \textcolor{keywordtype}{int} size) : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(seed, size) \{\}}
\DoxyCodeLine{106   \mbox{\hyperlink{classMTRand}{\string~MTRand}}() \{\}}
\DoxyCodeLine{107   \textcolor{keywordtype}{double} operator()()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{108     \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(rand\_int32()) * (1. / 4294967296.); \} \textcolor{comment}{// divided by 2\string^32}}
\DoxyCodeLine{109 \textcolor{keyword}{private}:}
\DoxyCodeLine{110   \mbox{\hyperlink{classMTRand}{MTRand}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand}{MTRand}}\&); \textcolor{comment}{// copy constructor not defined}}
\DoxyCodeLine{111   \textcolor{keywordtype}{void} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand}{MTRand}}\&); \textcolor{comment}{// assignment operator not defined}}
\DoxyCodeLine{112 \};}
\DoxyCodeLine{113 }
\DoxyCodeLine{114 \textcolor{comment}{// generates double floating point numbers in the closed interval [0, 1]}}
\DoxyCodeLine{115 \textcolor{keyword}{class }\mbox{\hyperlink{classMTRand__closed}{MTRand\_closed}} : \textcolor{keyword}{public} \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}} \{}
\DoxyCodeLine{116 \textcolor{keyword}{public}:}
\DoxyCodeLine{117   \mbox{\hyperlink{classMTRand__closed}{MTRand\_closed}}() : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}() \{\}}
\DoxyCodeLine{118   \mbox{\hyperlink{classMTRand__closed}{MTRand\_closed}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} seed) : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(seed) \{\}}
\DoxyCodeLine{119   \mbox{\hyperlink{classMTRand__closed}{MTRand\_closed}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}* seed, \textcolor{keywordtype}{int} size) : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(seed, size) \{\}}
\DoxyCodeLine{120   \mbox{\hyperlink{classMTRand__closed}{\string~MTRand\_closed}}() \{\}}
\DoxyCodeLine{121   \textcolor{keywordtype}{double} operator()() \{}
\DoxyCodeLine{122     \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(rand\_int32()) * (1. / 4294967295.); \} \textcolor{comment}{// divided by 2\string^32 -\/ 1}}
\DoxyCodeLine{123 \textcolor{keyword}{private}:}
\DoxyCodeLine{124   \mbox{\hyperlink{classMTRand__closed}{MTRand\_closed}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand__closed}{MTRand\_closed}}\&); \textcolor{comment}{// copy constructor not defined}}
\DoxyCodeLine{125   \textcolor{keywordtype}{void} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand__closed}{MTRand\_closed}}\&); \textcolor{comment}{// assignment operator not defined}}
\DoxyCodeLine{126 \};}
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \textcolor{comment}{// generates double floating point numbers in the open interval (0, 1)}}
\DoxyCodeLine{129 \textcolor{keyword}{class  }\mbox{\hyperlink{classMTRand__open}{MTRand\_open}} : \textcolor{keyword}{public} \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}} \{}
\DoxyCodeLine{130 \textcolor{keyword}{public}:}
\DoxyCodeLine{131   \mbox{\hyperlink{classMTRand__open}{MTRand\_open}}() : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}() \{\}}
\DoxyCodeLine{132   \mbox{\hyperlink{classMTRand__open}{MTRand\_open}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} seed) : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(seed) \{\}}
\DoxyCodeLine{133   \mbox{\hyperlink{classMTRand__open}{MTRand\_open}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}* seed, \textcolor{keywordtype}{int} size) : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(seed, size) \{\}}
\DoxyCodeLine{134   \mbox{\hyperlink{classMTRand__open}{\string~MTRand\_open}}() \{\}}
\DoxyCodeLine{135   \textcolor{keywordtype}{double} operator()() \{}
\DoxyCodeLine{136     \textcolor{keywordflow}{return} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(rand\_int32()) + .5) * (1. / 4294967296.); \} \textcolor{comment}{// divided by 2\string^32}}
\DoxyCodeLine{137 \textcolor{keyword}{private}:}
\DoxyCodeLine{138   \mbox{\hyperlink{classMTRand__open}{MTRand\_open}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand__open}{MTRand\_open}}\&); \textcolor{comment}{// copy constructor not defined}}
\DoxyCodeLine{139   \textcolor{keywordtype}{void} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand__open}{MTRand\_open}}\&); \textcolor{comment}{// assignment operator not defined}}
\DoxyCodeLine{140 \};}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 \textcolor{comment}{// generates 53 bit resolution doubles in the half-\/open interval [0, 1)}}
\DoxyCodeLine{143 \textcolor{keyword}{class }\mbox{\hyperlink{classMTRand53}{MTRand53}} : \textcolor{keyword}{public} \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}} \{}
\DoxyCodeLine{144 \textcolor{keyword}{public}:}
\DoxyCodeLine{145   \mbox{\hyperlink{classMTRand53}{MTRand53}}() : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}() \{\}}
\DoxyCodeLine{146   \mbox{\hyperlink{classMTRand53}{MTRand53}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} seed) : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(seed) \{\}}
\DoxyCodeLine{147   \mbox{\hyperlink{classMTRand53}{MTRand53}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}* seed, \textcolor{keywordtype}{int} size) : \mbox{\hyperlink{classMTRand__int32}{MTRand\_int32}}(seed, size) \{\}}
\DoxyCodeLine{148   \mbox{\hyperlink{classMTRand53}{\string~MTRand53}}() \{\}}
\DoxyCodeLine{149   \textcolor{keywordtype}{double} operator()() \{}
\DoxyCodeLine{150     \textcolor{keywordflow}{return} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(rand\_int32() >> 5) * 67108864. +}
\DoxyCodeLine{151       \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(rand\_int32() >> 6)) * (1. / 9007199254740992.); \}}
\DoxyCodeLine{152 \textcolor{keyword}{private}:}
\DoxyCodeLine{153   \mbox{\hyperlink{classMTRand53}{MTRand53}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand53}{MTRand53}}\&); \textcolor{comment}{// copy constructor not defined}}
\DoxyCodeLine{154   \textcolor{keywordtype}{void} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classMTRand53}{MTRand53}}\&); \textcolor{comment}{// assignment operator not defined}}
\DoxyCodeLine{155 \};}
\DoxyCodeLine{156 }
\DoxyCodeLine{157 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// MTRAND\_H}}

\end{DoxyCode}
