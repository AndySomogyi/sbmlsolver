\hypertarget{GillespieIntegrator_8h_source}{}\doxysection{Gillespie\+Integrator.\+h}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// == PREAMBLE ================================================}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{comment}{// * Licensed under the Apache License, Version 2.0; see README}}
\DoxyCodeLine{4 }
\DoxyCodeLine{5 \textcolor{comment}{// == FILEDOC =================================================}}
\DoxyCodeLine{6 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#ifndef GILLESPIEINTEGRATOR\_H\_}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define GILLESPIEINTEGRATOR\_H\_}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{comment}{// == INCLUDES ================================================}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Integrator_8h}{Integrator.h}}"{}}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}rrRoadRunnerOptions.h"{}}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{rrExecutableModel_8h}{rrExecutableModel.h}}"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}tr1proxy/rr\_random.h"{}}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{comment}{// == CODE ====================================================}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keyword}{namespace }rr}
\DoxyCodeLine{27 \{}
\DoxyCodeLine{28 }
\DoxyCodeLine{29     \textcolor{keyword}{class }ExecutableModel;}
\DoxyCodeLine{30 }
\DoxyCodeLine{35     \textcolor{keyword}{class }\mbox{\hyperlink{classrr_1_1GillespieIntegrator}{GillespieIntegrator}}: \textcolor{keyword}{public} \mbox{\hyperlink{classrr_1_1Integrator}{Integrator}}}
\DoxyCodeLine{36     \{}
\DoxyCodeLine{37     \textcolor{keyword}{public}:}
\DoxyCodeLine{38         \textcolor{keyword}{using} Integrator::Integrator;}
\DoxyCodeLine{39 }
\DoxyCodeLine{40         \mbox{\hyperlink{classrr_1_1GillespieIntegrator}{GillespieIntegrator}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}}* model);}
\DoxyCodeLine{41 }
\DoxyCodeLine{42         \mbox{\hyperlink{classrr_1_1GillespieIntegrator}{\string~GillespieIntegrator}}() \textcolor{keyword}{override};}
\DoxyCodeLine{43 }
\DoxyCodeLine{49         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1GillespieIntegrator_ad928d3d4e5efbe04dcc2ab503119c745}{syncWithModel}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}}* m) \textcolor{keyword}{override};}
\DoxyCodeLine{50 }
\DoxyCodeLine{51         \textcolor{comment}{// ** Meta Info ********************************************************}}
\DoxyCodeLine{52 }
\DoxyCodeLine{58         std::string \mbox{\hyperlink{classrr_1_1GillespieIntegrator_a53116ebe5ea51e363d1588a9db6cb876}{getName}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{59 }
\DoxyCodeLine{65         std::string \mbox{\hyperlink{classrr_1_1GillespieIntegrator_a7579da7a2ae861f8e9548a6ab6826595}{getDescription}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{66 }
\DoxyCodeLine{72         std::string \mbox{\hyperlink{classrr_1_1GillespieIntegrator_a19d0e00231f3f59c1291090558695cee}{getHint}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{73 }
\DoxyCodeLine{74         \mbox{\hyperlink{classrr_1_1Solver}{Solver}}* \mbox{\hyperlink{classrr_1_1GillespieIntegrator_a3ba0c5feae9d3e0f6cc24a671183e430}{construct}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}}* executableModel) \textcolor{keyword}{const override};}
\DoxyCodeLine{75 }
\DoxyCodeLine{76         \textcolor{comment}{// ** Getters / Setters ************************************************}}
\DoxyCodeLine{77 }
\DoxyCodeLine{82         IntegrationMethod \mbox{\hyperlink{classrr_1_1GillespieIntegrator_a9fe029c162b37172c49f2175c69eb8fc}{getIntegrationMethod}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{83 }
\DoxyCodeLine{88         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1GillespieIntegrator_aa21499e410b057552054665291618348}{setValue}}(\textcolor{keyword}{const} std::string\& setting, \mbox{\hyperlink{classrr_1_1Setting}{Setting}} value) \textcolor{keyword}{override};}
\DoxyCodeLine{89 }
\DoxyCodeLine{94         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1GillespieIntegrator_ac72e6b148def07a53c79e83441b380cd}{resetSettings}}() \textcolor{keyword}{override};}
\DoxyCodeLine{95 }
\DoxyCodeLine{96         \textcolor{comment}{// ** Integration Routines *********************************************}}
\DoxyCodeLine{97 }
\DoxyCodeLine{102         \textcolor{keywordtype}{double} \mbox{\hyperlink{classrr_1_1GillespieIntegrator_a37f3be6adad08270982ba790c721aa64}{integrate}}(\textcolor{keywordtype}{double} t0, \textcolor{keywordtype}{double} tf) \textcolor{keyword}{override};}
\DoxyCodeLine{103 }
\DoxyCodeLine{108         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1GillespieIntegrator_a262d1d16bd30c35269cd3daabfd1b574}{restart}}(\textcolor{keywordtype}{double} timeStart) \textcolor{keyword}{override};}
\DoxyCodeLine{109 }
\DoxyCodeLine{110         \textcolor{comment}{// ** Listeners ********************************************************}}
\DoxyCodeLine{111 }
\DoxyCodeLine{116         IntegratorListenerPtr \mbox{\hyperlink{classrr_1_1GillespieIntegrator_aa412e44a4edb787ea54c397de0a94429}{getListener}}() \textcolor{keyword}{override};}
\DoxyCodeLine{117 }
\DoxyCodeLine{122         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1GillespieIntegrator_ad90d4e1cc786cb9e9231cdcfc42a01ed}{setListener}}(IntegratorListenerPtr) \textcolor{keyword}{override};}
\DoxyCodeLine{123 }
\DoxyCodeLine{124     \textcolor{keyword}{private}:}
\DoxyCodeLine{125         std::mt19937 engine;}
\DoxyCodeLine{126         \textcolor{comment}{//unsigned long seed;}}
\DoxyCodeLine{127         \textcolor{keywordtype}{double} timeScale;}
\DoxyCodeLine{128         \textcolor{keywordtype}{double} stoichScale;}
\DoxyCodeLine{129         \textcolor{keywordtype}{int} nReactions;}
\DoxyCodeLine{130         \textcolor{keywordtype}{int} floatingSpeciesStart;       \textcolor{comment}{// starting index of floating species}}
\DoxyCodeLine{131         \textcolor{keywordtype}{double}* reactionRates;}
\DoxyCodeLine{132         \textcolor{keywordtype}{double}* reactionRatesBuffer;}
\DoxyCodeLine{133         \textcolor{keywordtype}{int} stateVectorSize;}
\DoxyCodeLine{134         \textcolor{keywordtype}{double}* stateVector;}
\DoxyCodeLine{135         \textcolor{keywordtype}{double}* stateVectorRate;}
\DoxyCodeLine{136         \textcolor{comment}{// m rows x n cols}}
\DoxyCodeLine{137         \textcolor{comment}{// offset = row*NUMCOLS + column}}
\DoxyCodeLine{138         \textcolor{keywordtype}{int} stoichRows;}
\DoxyCodeLine{139         \textcolor{keywordtype}{int} stoichCols;}
\DoxyCodeLine{140         \textcolor{keywordtype}{double}* stoichData;}
\DoxyCodeLine{141         std::vector<unsigned char> eventStatus;}
\DoxyCodeLine{142         std::vector<unsigned char> previousEventStatus;}
\DoxyCodeLine{143 }
\DoxyCodeLine{144         \textcolor{keywordtype}{void} testRootsAtInitialTime();}
\DoxyCodeLine{145         \textcolor{keywordtype}{void} applyEvents(\textcolor{keywordtype}{double} timeEnd, std::vector<unsigned char> \&prevEventStatus);}
\DoxyCodeLine{146 }
\DoxyCodeLine{147         \textcolor{keywordtype}{double} urand();}
\DoxyCodeLine{148         \textcolor{keywordtype}{void} setEngineSeed(std::uint64\_t seed);}
\DoxyCodeLine{149         std::uint64\_t getSeed() \textcolor{keyword}{const};}
\DoxyCodeLine{150 }
\DoxyCodeLine{151         \textcolor{keyword}{inline} \textcolor{keywordtype}{double} getStoich(uint species, uint reaction)}
\DoxyCodeLine{152         \{}
\DoxyCodeLine{153             \textcolor{keywordflow}{return} stoichData[species * stoichCols + reaction];}
\DoxyCodeLine{154         \}}
\DoxyCodeLine{155 }
\DoxyCodeLine{162         \textcolor{keywordtype}{void} initializeFromModel();}
\DoxyCodeLine{163     \};}
\DoxyCodeLine{164 \} \textcolor{comment}{/* namespace rr */}}
\DoxyCodeLine{165 }
\DoxyCodeLine{166 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* GILLESPIEINTEGRATOR\_H\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
