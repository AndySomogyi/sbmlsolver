\hypertarget{ForwardSensitivitySolver_8h_source}{}\doxysection{Forward\+Sensitivity\+Solver.\+h}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//}}
\DoxyCodeLine{2 \textcolor{comment}{// Created by Ciaran Welsh on 09/06/2021.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 }
\DoxyCodeLine{5 \textcolor{preprocessor}{\#ifndef ROADRUNNER\_SENSITIVITIES\_H}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#define ROADRUNNER\_SENSITIVITIES\_H}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{CVODEIntegrator_8h}{CVODEIntegrator.h}}"{}}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}SensitivitySolver.h"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{LLVMExecutableModel_8h}{LLVMExecutableModel.h}}"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}Matrix.h"{}}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}Matrix3D.h"{}}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}nvector/nvector\_serial.h"{}}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{keyword}{namespace }rr \{}
\DoxyCodeLine{19 }
\DoxyCodeLine{20     \textcolor{keyword}{using} ParameterMap = std::unordered\_map<std::string, double>;}
\DoxyCodeLine{21 }
\DoxyCodeLine{22     \textcolor{keyword}{class }CVODEIntegrator;}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 }
\DoxyCodeLine{31     \textcolor{keyword}{class }\mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver}{ForwardSensitivitySolver}} : \textcolor{keyword}{public} \mbox{\hyperlink{classrr_1_1TimeSeriesSensitivitySolver}{TimeSeriesSensitivitySolver}} \{}
\DoxyCodeLine{32     \textcolor{keyword}{public}:}
\DoxyCodeLine{33 }
\DoxyCodeLine{34         \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver}{ForwardSensitivitySolver}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{35 }
\DoxyCodeLine{36         \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver}{\string~ForwardSensitivitySolver}}() \textcolor{keyword}{override};}
\DoxyCodeLine{37 }
\DoxyCodeLine{38         \textcolor{keyword}{explicit} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver}{ForwardSensitivitySolver}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}} *executableModel);}
\DoxyCodeLine{39 }
\DoxyCodeLine{40         \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver}{ForwardSensitivitySolver}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}} *executableModel, std::vector<std::string> \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a5ccab42d7414fe3bf6407805d8472eb8}{whichParameters}});}
\DoxyCodeLine{41 }
\DoxyCodeLine{42         \textcolor{keywordtype}{double} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a5617f1a29c1b3394a5bbf1bef36a3ab3}{integrate}}(\textcolor{keywordtype}{double} tStart, \textcolor{keywordtype}{double} hstep) \textcolor{keyword}{override};}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 }
\DoxyCodeLine{48         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a7649a64267a6bad7d691a95252941b17}{create}}();}
\DoxyCodeLine{49 }
\DoxyCodeLine{53         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a9f78958e67898b39a0f70ff4207583a1}{freeSundialsMemory}}();}
\DoxyCodeLine{54 }
\DoxyCodeLine{58         std::string \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a38a772f5306181ab61940bd453059ce4}{getName}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{59 }
\DoxyCodeLine{63         std::string \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_ad1f87f41aa3d2798b5b129f1ca773a08}{getDescription}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{64 }
\DoxyCodeLine{68         std::string \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a7ebffaf9c2b7d876ba0a845e869b0558}{getHint}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{69 }
\DoxyCodeLine{70         \mbox{\hyperlink{classrr_1_1Solver}{Solver}} *\mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_ae938e625ed4e8d3536b6b3fb9371a08d}{construct}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}} *executableModel) \textcolor{keyword}{const override};}
\DoxyCodeLine{71 }
\DoxyCodeLine{75         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a66033d9628dea4a1e2ffc2158087a2e1}{resetSettings}}() \textcolor{keyword}{override};}
\DoxyCodeLine{76 }
\DoxyCodeLine{77         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_aa0560086789464708c95896272e1b5ce}{syncWithModel}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}} *executableModel) \textcolor{keyword}{override};}
\DoxyCodeLine{78 }
\DoxyCodeLine{79         std::string \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_acd883d6f972f3735251d363a69ae9da1}{toRepr}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{80 }
\DoxyCodeLine{81         \textcolor{keywordtype}{void} loadConfigSettings();}
\DoxyCodeLine{82 }
\DoxyCodeLine{83         std::string \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a3d626fc6eb7f2698840a4d2a94da5720}{toString}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{84 }
\DoxyCodeLine{89         std::vector<std::string> \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_ad71e98f12d325629eb22b6473ec48cb4}{getGlobalParameterNames}}();}
\DoxyCodeLine{90 }
\DoxyCodeLine{97         std::vector<std::string> \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_ae1bc2fdffabdd3c03b1fb992b94d3efe}{getVariableNames}}();}
\DoxyCodeLine{98 }
\DoxyCodeLine{103         ParameterMap \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_af5953818d5d18ee9537733e4553525cf}{getModelParametersAsMap}}();}
\DoxyCodeLine{104 }
\DoxyCodeLine{109         std::vector<double> \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a7d4821b296ddd8878ce8d490598bf0d2}{getModelParametersAsVector}}();}
\DoxyCodeLine{110 }
\DoxyCodeLine{115         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_aed656c6267d711b2e2d45574a42695a8}{deducePlist}}();}
\DoxyCodeLine{116 }
\DoxyCodeLine{121         N\_Vector \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_ae2da77e914bbff9a93ef44c2c3546a3b}{getStateVector}}();}
\DoxyCodeLine{122 }
\DoxyCodeLine{127         N\_Vector *\mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a7aa4a017b53b2e2ae10d09c1f1747efd}{getSensitivityNVectorPtr}}();}
\DoxyCodeLine{128 }
\DoxyCodeLine{134         \mbox{\hyperlink{classrr_1_1Matrix}{rr::Matrix<double>}} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a7fa7605a48dbc60c2d86fcdcf3d34f35}{getSensitivityMatrix}}(\textcolor{keywordtype}{int} k = 0) \textcolor{keyword}{override};}
\DoxyCodeLine{135 }
\DoxyCodeLine{151         \mbox{\hyperlink{classrr_1_1Matrix3D}{Matrix3D<double, double>}} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a4af4074ec94416300658878cf7c0c513}{solveSensitivities}}(\textcolor{keywordtype}{double} start, \textcolor{keywordtype}{double} stop, \textcolor{keywordtype}{int} num,}
\DoxyCodeLine{152                                                     std::vector<std::string> params = std::vector<std::string>(),}
\DoxyCodeLine{153                                                     std::vector<std::string> species = std::vector<std::string>(),}
\DoxyCodeLine{154                                                     \textcolor{keywordtype}{int} k = 0) \textcolor{keyword}{override};}
\DoxyCodeLine{155 }
\DoxyCodeLine{156         \textcolor{keywordtype}{void} setValue(\textcolor{keyword}{const} std::string \&key, \mbox{\hyperlink{classrr_1_1Setting}{Setting}} val) \textcolor{keyword}{override};}
\DoxyCodeLine{157 }
\DoxyCodeLine{166         std::vector<double> \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_ad8e9532fb451fb07102d541c0c99431d}{p}};}
\DoxyCodeLine{167 }
\DoxyCodeLine{173         std::vector<double> \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_af70b5c29f06f44ff929f716e685db223}{pbar}};}
\DoxyCodeLine{174 }
\DoxyCodeLine{179         std::vector<int> \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_aab51eee428bdc2a931fdef6034c43115}{plist}};}
\DoxyCodeLine{180 }
\DoxyCodeLine{184         std::vector<std::string> \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a5ccab42d7414fe3bf6407805d8472eb8}{whichParameters}};}
\DoxyCodeLine{185 }
\DoxyCodeLine{189         ParameterMap \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a051a2fd4e4a5a644b5f4b32f425e3552}{globalParameterMap}};}
\DoxyCodeLine{190 }
\DoxyCodeLine{194         \textcolor{keywordtype}{int} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_a9cf514ad265733e39fa93296e27726d2}{Np}} = 0;}
\DoxyCodeLine{195 }
\DoxyCodeLine{199         \textcolor{keywordtype}{int} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_ace176b4a2248e742351ddd30d4d900ba}{Ns}} = 0;}
\DoxyCodeLine{200 }
\DoxyCodeLine{205         \textcolor{keywordtype}{int} \mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver_aa84e84aba27a1fd6826cd7581b228d39}{numModelVariables}} = 0;}
\DoxyCodeLine{206 }
\DoxyCodeLine{207     \textcolor{keyword}{private}:}
\DoxyCodeLine{208 }
\DoxyCodeLine{217         std::unique\_ptr<CVODEIntegrator> cvodeIntegrator = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{218 }
\DoxyCodeLine{219         \textcolor{keywordtype}{void} constructorOperations();}
\DoxyCodeLine{220 }
\DoxyCodeLine{231         \textcolor{keywordtype}{void} setDefaultWhichParameters();}
\DoxyCodeLine{232 }
\DoxyCodeLine{246         \textcolor{keywordtype}{bool} usingDefaultWhichParameters = \textcolor{keyword}{true};}
\DoxyCodeLine{247 }
\DoxyCodeLine{258         \textcolor{keywordtype}{bool} usingUseWhichParametersFromConstructor = \textcolor{keyword}{false};}
\DoxyCodeLine{259 }
\DoxyCodeLine{263         SUNNonlinearSolver NLSsens = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{264 }
\DoxyCodeLine{268         N\_Vector *mSensitivityMatrix = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{269 \textcolor{comment}{//        using NVectorArrayPtr = std::unique\_ptr<N\_Vector*, std::function<void( N\_Vector*, int)>>;}}
\DoxyCodeLine{270 \textcolor{comment}{//        using NVectorArrayPtr = std::unique\_ptr<N\_Vector*, decltype(\&N\_VDestroyVectorArray\_Serial)>;}}
\DoxyCodeLine{271 \textcolor{comment}{//        NVectorArrayPtr mSensitivityMatrixUnique = std::make\_unique<N\_Vector*, decltype(\&N\_VDestroyVectorArray\_Serial)>(nullptr);}}
\DoxyCodeLine{272 }
\DoxyCodeLine{273         \textcolor{keywordtype}{int} mSensitivityMatrixSize = 0;}
\DoxyCodeLine{274 }
\DoxyCodeLine{279         \textcolor{keywordtype}{bool} stateVectorVariables = \textcolor{keyword}{false};}
\DoxyCodeLine{280 }
\DoxyCodeLine{284         std::vector<std::string> getParameterNamesFromPlist();}
\DoxyCodeLine{285 }
\DoxyCodeLine{289         std::vector<double> getParameterValuesFromPlist();}
\DoxyCodeLine{290 }
\DoxyCodeLine{291         \textcolor{keyword}{friend} \textcolor{keywordtype}{int} FFSDyDtFcn(realtype time, N\_Vector cv\_y, N\_Vector cv\_ydot, \textcolor{keywordtype}{void} *userData);}
\DoxyCodeLine{292 }
\DoxyCodeLine{293         \textcolor{keyword}{friend} \textcolor{keywordtype}{int} FFSRootFcn(realtype time, N\_Vector y\_vector, realtype *gout, \textcolor{keywordtype}{void} *user\_data);}
\DoxyCodeLine{294 }
\DoxyCodeLine{295     \};}
\DoxyCodeLine{296 }
\DoxyCodeLine{297 }
\DoxyCodeLine{298 }
\DoxyCodeLine{299 \}}
\DoxyCodeLine{300 }
\DoxyCodeLine{301 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//ROADRUNNER\_SENSITIVITIES\_H}}

\end{DoxyCode}
