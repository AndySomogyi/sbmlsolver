\hypertarget{CVODEIntegrator_8h_source}{}\doxysection{CVODEIntegrator.\+h}
\mbox{\hyperlink{CVODEIntegrator_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// == PREAMBLE ================================================}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{comment}{// * Licensed under the Apache License, Version 2.0; see README}}
\DoxyCodeLine{4 }
\DoxyCodeLine{5 \textcolor{comment}{// == FILEDOC =================================================}}
\DoxyCodeLine{6 }
\DoxyCodeLine{13 \textcolor{comment}{//todo replace the include guards to match the filename}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#ifndef rrCvodeInterfaceH}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define rrCvodeInterfaceH}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Integrator_8h}{Integrator.h}}"{}}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include "{}rrRoadRunnerOptions.h"{}}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <sundials/sundials\_linearsolver.h>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <sundials/sundials\_nonlinearsolver.h>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <cvodes/cvodes.h>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <sundials/sundials\_nvector.h>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}ForwardSensitivitySolver.h"{}}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{namespace }rr \{}
\DoxyCodeLine{30     \textcolor{keyword}{using} std::string;}
\DoxyCodeLine{31 }
\DoxyCodeLine{32     \textcolor{keyword}{class }ExecutableModel;}
\DoxyCodeLine{33 }
\DoxyCodeLine{34     \textcolor{keyword}{class }RoadRunner;}
\DoxyCodeLine{35 }
\DoxyCodeLine{36     \textcolor{keyword}{class }ForwardSensitivitySolver;}
\DoxyCodeLine{37 }
\DoxyCodeLine{46     \textcolor{keyword}{class }\mbox{\hyperlink{classrr_1_1CVODEIntegrator}{CVODEIntegrator}} : \textcolor{keyword}{public} \mbox{\hyperlink{classrr_1_1Integrator}{Integrator}} \{}
\DoxyCodeLine{47 }
\DoxyCodeLine{48     \textcolor{keyword}{public}:}
\DoxyCodeLine{49 }
\DoxyCodeLine{50         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classrr_1_1ForwardSensitivitySolver}{ForwardSensitivitySolver}};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         \textcolor{keyword}{using} Integrator::Integrator;}
\DoxyCodeLine{53 }
\DoxyCodeLine{58         \textcolor{keyword}{explicit} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_ad83f14144a59c66b5feac18d37a22060}{CVODEIntegrator}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}} *oModel);}
\DoxyCodeLine{59 }
\DoxyCodeLine{64         \mbox{\hyperlink{classrr_1_1CVODEIntegrator_ad60746a373a8de7a5163d56475bfd55c}{\string~CVODEIntegrator}}() \textcolor{keyword}{override};}
\DoxyCodeLine{65 }
\DoxyCodeLine{71         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a6ffad2eceae5fda58900a1bbaa738eff}{syncWithModel}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}} *m) \textcolor{keyword}{override};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73         \textcolor{comment}{// ** Loading Settings *************************************************}}
\DoxyCodeLine{74 }
\DoxyCodeLine{79         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_ac43da51656919e15d30f450e81b3887b}{loadConfigSettings}}() \textcolor{keyword}{override};}
\DoxyCodeLine{80 }
\DoxyCodeLine{86         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_acaa6878fb0d972aa96dba554a7bc65a4}{loadSBMLSettings}}(\textcolor{keyword}{const} std::string \&filename) \textcolor{keyword}{override};}
\DoxyCodeLine{87 }
\DoxyCodeLine{88         \textcolor{comment}{// ** Meta Info ********************************************************}}
\DoxyCodeLine{89 }
\DoxyCodeLine{95         std::string \mbox{\hyperlink{classrr_1_1CVODEIntegrator_aa889b08549036792918c41e88e2097f4}{getName}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{96 }
\DoxyCodeLine{102         std::string \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a1c6a393504cc85f2dc236abd0cb5577a}{getDescription}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{103 }
\DoxyCodeLine{109         std::string \mbox{\hyperlink{classrr_1_1CVODEIntegrator_addde67b3639fe1347efc2a37bbfdd60e}{getHint}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{110 }
\DoxyCodeLine{116         \mbox{\hyperlink{classrr_1_1Solver}{Solver}} *\mbox{\hyperlink{classrr_1_1CVODEIntegrator_aa255a6f4cd2091304851a2f699f4a9fc}{construct}}(\mbox{\hyperlink{classrr_1_1ExecutableModel}{ExecutableModel}} *executableModel) \textcolor{keyword}{const override};}
\DoxyCodeLine{117 }
\DoxyCodeLine{118         \textcolor{comment}{// ** Getters / Setters ************************************************}}
\DoxyCodeLine{119 }
\DoxyCodeLine{124         IntegrationMethod \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a7cc1f774e58f179fb2e69c515c9f2a1f}{getIntegrationMethod}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{125 }
\DoxyCodeLine{130         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a2ba8be5c51129d05dd8ab5315dc12edc}{setValue}}(\textcolor{keyword}{const} std::string \&setting, \mbox{\hyperlink{classrr_1_1Setting}{Setting}} value) \textcolor{keyword}{override};}
\DoxyCodeLine{131 }
\DoxyCodeLine{139         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a6b9189a5d39d8c33541ea82ad9a382a4}{setMaxOrder}}(\textcolor{keywordtype}{int} newValue);}
\DoxyCodeLine{140 }
\DoxyCodeLine{145         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a57e9e604b2c2ba388a3fe219e87c326c}{setIndividualTolerance}}(std::string sid, \textcolor{keywordtype}{double} value) \textcolor{keyword}{override};}
\DoxyCodeLine{146 }
\DoxyCodeLine{154         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a386a755bab0c72a5d93a7e09ba95fafe}{setConcentrationTolerance}}(\mbox{\hyperlink{classrr_1_1Setting}{Setting}} value) \textcolor{keyword}{override};}
\DoxyCodeLine{155 }
\DoxyCodeLine{160         std::vector<double> \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a7f68228148cf04688881f636a34deb48}{getConcentrationTolerance}}() \textcolor{keyword}{override};}
\DoxyCodeLine{161 }
\DoxyCodeLine{166         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_ac18581f5c000940449032e166ef48e79}{resetSettings}}() \textcolor{keyword}{override};}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 }
\DoxyCodeLine{177         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a137ada502a737819ca3ad78d0573c35d}{tweakTolerances}}() \textcolor{keyword}{override};}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 }
\DoxyCodeLine{180         \textcolor{comment}{// ** Integration Routines *********************************************}}
\DoxyCodeLine{181 }
\DoxyCodeLine{186         \textcolor{keywordtype}{double} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a1e29429af0ec90aa2f47be15bbe8856c}{integrate}}(\textcolor{keywordtype}{double} t0, \textcolor{keywordtype}{double} hstep) \textcolor{keyword}{override};}
\DoxyCodeLine{187 }
\DoxyCodeLine{194         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_acde5e92ec049c105b7d22b0f125d94a9}{restart}}(\textcolor{keywordtype}{double} timeStart) \textcolor{keyword}{override};}
\DoxyCodeLine{195 }
\DoxyCodeLine{196         \textcolor{comment}{// ** Listeners ********************************************************}}
\DoxyCodeLine{197 }
\DoxyCodeLine{202         IntegratorListenerPtr \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a480b8dad2e4dabcdb8fec1439ab7c5f7}{getListener}}() \textcolor{keyword}{override};}
\DoxyCodeLine{203 }
\DoxyCodeLine{208         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_aca2901ed7b5a503e054fd18e8f0392ad}{setListener}}(IntegratorListenerPtr) \textcolor{keyword}{override};}
\DoxyCodeLine{209 }
\DoxyCodeLine{214         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a7f67f51344e7a63ac6a84f67046dfbc5}{checkType}}() \textcolor{keyword}{const};}
\DoxyCodeLine{215 }
\DoxyCodeLine{216 }
\DoxyCodeLine{221         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_afdbcc5be9fb361ffdedf2364118b87f3}{checkVectorSize}}(\textcolor{keywordtype}{int} expected, \textcolor{keywordtype}{size\_t} real) \textcolor{keyword}{const};}
\DoxyCodeLine{222 }
\DoxyCodeLine{227         \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a8f2a01ce70a6aa67e652b9d9dde9be08}{checkIndex}}(\textcolor{keywordtype}{int} index, \textcolor{keywordtype}{int} size) \textcolor{keyword}{const};}
\DoxyCodeLine{228 }
\DoxyCodeLine{233         std::string \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a38290b6c0c66556fed4a9e673c6ddd69}{ToString}}(\textcolor{keywordtype}{int} val) \textcolor{keyword}{const};}
\DoxyCodeLine{234 }
\DoxyCodeLine{239         std::string \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a38290b6c0c66556fed4a9e673c6ddd69}{ToString}}(\textcolor{keywordtype}{size\_t} val) \textcolor{keyword}{const};}
\DoxyCodeLine{240 }
\DoxyCodeLine{244         N\_Vector \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a20f0ef30d096122a556f8690b81d7ef0}{getStateVector}}() \textcolor{keyword}{const};}
\DoxyCodeLine{245 }
\DoxyCodeLine{249         SUNNonlinearSolver \mbox{\hyperlink{classrr_1_1CVODEIntegrator_a72452ef342616919777874ba32dcd1c3}{getSolver}}() \textcolor{keyword}{const};}
\DoxyCodeLine{250 }
\DoxyCodeLine{254         \textcolor{keywordtype}{void} *\mbox{\hyperlink{classrr_1_1CVODEIntegrator_ad3ad4d2d9d49bce33f8d34d177ff703a}{getCvodeMemory}}() \textcolor{keyword}{const};}
\DoxyCodeLine{255 }
\DoxyCodeLine{256     \textcolor{keyword}{private}:}
\DoxyCodeLine{257         \textcolor{comment}{// defaults directly from CVODE docs}}
\DoxyCodeLine{258         \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} mDefaultMaxNumSteps;}
\DoxyCodeLine{259         \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} mDefaultMaxAdamsOrder;}
\DoxyCodeLine{260         \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} mDefaultMaxBDFOrder;}
\DoxyCodeLine{261 }
\DoxyCodeLine{262         \textcolor{comment}{// cvode components}}
\DoxyCodeLine{263         \textcolor{keywordtype}{void} *mCVODE\_Memory = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{264         N\_Vector mStateVector = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{265         SUNMatrix jac = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{266         SUNNonlinearSolver nonLinSolver = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{267         SUNLinearSolver linSolver = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{268 }
\DoxyCodeLine{269         IntegratorListenerPtr listener;}
\DoxyCodeLine{270         \textcolor{keywordtype}{double} mLastEventTime;}
\DoxyCodeLine{271         \textcolor{keywordtype}{bool} variableStepPendingEvent;}
\DoxyCodeLine{272         \textcolor{keywordtype}{bool} variableStepTimeEndEvent;}
\DoxyCodeLine{273         std::vector<double> variableStepPostEventState;}
\DoxyCodeLine{274         std::vector<unsigned char> eventStatus;}
\DoxyCodeLine{275 }
\DoxyCodeLine{276         \textcolor{keywordtype}{void} testRootsAtInitialTime();}
\DoxyCodeLine{277 }
\DoxyCodeLine{278         \textcolor{keywordtype}{bool} haveVariables() \textcolor{keyword}{const};}
\DoxyCodeLine{279 }
\DoxyCodeLine{280         \textcolor{keywordtype}{void} assignResultsToModel() \textcolor{keyword}{const};}
\DoxyCodeLine{281 }
\DoxyCodeLine{287         \textcolor{keywordtype}{void} setCVODETolerances();}
\DoxyCodeLine{288 }
\DoxyCodeLine{292         \textcolor{keywordtype}{void} reInit(\textcolor{keywordtype}{double} t0);}
\DoxyCodeLine{293 }
\DoxyCodeLine{304         \textcolor{keywordtype}{void} updateCVODE();}
\DoxyCodeLine{305 }
\DoxyCodeLine{306         \textcolor{keywordtype}{void} applyPendingEvents(\textcolor{keywordtype}{double} timeEnd);}
\DoxyCodeLine{307 }
\DoxyCodeLine{308         \textcolor{keywordtype}{void} applyEvents(\textcolor{keywordtype}{double} timeEnd, std::vector<unsigned char> \&previousEventStatus);}
\DoxyCodeLine{309 }
\DoxyCodeLine{310         \textcolor{keywordtype}{double} applyVariableStepPendingEvents();}
\DoxyCodeLine{311 }
\DoxyCodeLine{312         \textcolor{keywordtype}{void} create();}
\DoxyCodeLine{313 }
\DoxyCodeLine{314         \textcolor{keywordtype}{void} freeSundialsMemory();}
\DoxyCodeLine{315 }
\DoxyCodeLine{316         \textcolor{keywordtype}{bool} stateVectorVariables;}
\DoxyCodeLine{317 }
\DoxyCodeLine{318         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} typecode\_;}
\DoxyCodeLine{319 }
\DoxyCodeLine{320         \textcolor{keyword}{friend} \textcolor{keywordtype}{int} cvodeDyDtFcn(\textcolor{keywordtype}{double} t, N\_Vector cv\_y, N\_Vector cv\_ydot, \textcolor{keywordtype}{void} *f\_data);}
\DoxyCodeLine{321 }
\DoxyCodeLine{322         \textcolor{keyword}{friend} \textcolor{keywordtype}{int} cvodeRootFcn(\textcolor{keywordtype}{double} t, N\_Vector y, \textcolor{keywordtype}{double} *gout, \textcolor{keywordtype}{void} *g\_data);}
\DoxyCodeLine{323 }
\DoxyCodeLine{324     \};}
\DoxyCodeLine{325 }
\DoxyCodeLine{326     \textcolor{keyword}{template} <\textcolor{keyword}{class} SundialsType = CVODEIntegrator>}
\DoxyCodeLine{327     std::string decodeSundialsError(SundialsType* solver, \textcolor{keywordtype}{int} cvodeError, \textcolor{keywordtype}{bool} exInfo) \{}
\DoxyCodeLine{328         std::string result;}
\DoxyCodeLine{329         std::stringstream ss;}
\DoxyCodeLine{330         ss << (int) solver-\/>getValue(\textcolor{stringliteral}{"{}maximum\_num\_steps"{}});}
\DoxyCodeLine{331         std::string max\_steps = ss.str();}
\DoxyCodeLine{332 }
\DoxyCodeLine{333         \textcolor{keywordflow}{switch} (cvodeError) \{}
\DoxyCodeLine{334             \textcolor{keywordflow}{case} CV\_TOO\_MUCH\_WORK:}
\DoxyCodeLine{335                 result = \textcolor{stringliteral}{"{}CV\_TOO\_MUCH\_WORK"{}};}
\DoxyCodeLine{336                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{337                     result += \textcolor{stringliteral}{"{}: The solver took mxstep ("{}} + max\_steps + \textcolor{stringliteral}{"{}) internal steps but "{}} +}
\DoxyCodeLine{338                               \textcolor{stringliteral}{"{}could not reach tout."{}};}
\DoxyCodeLine{339                 \}}
\DoxyCodeLine{340                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{341             \textcolor{keywordflow}{case} CV\_TOO\_MUCH\_ACC:}
\DoxyCodeLine{342                 result = \textcolor{stringliteral}{"{}CV\_TOO\_MUCH\_ACC"{}};}
\DoxyCodeLine{343                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{344                     result += \textcolor{stringliteral}{"{}: The solver could not satisfy the accuracy "{}}}
\DoxyCodeLine{345                               \textcolor{stringliteral}{"{}demanded by the user for some internal step."{}};}
\DoxyCodeLine{346                 \}}
\DoxyCodeLine{347                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{348             \textcolor{keywordflow}{case} CV\_ERR\_FAILURE:}
\DoxyCodeLine{349                 result = \textcolor{stringliteral}{"{}CV\_ERR\_FAILURE"{}};}
\DoxyCodeLine{350                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{351                     result += \textcolor{stringliteral}{"{}: Error test failures occurred too many times "{}}}
\DoxyCodeLine{352                               \textcolor{stringliteral}{"{}(= MXNEF = 7) during one internal time step or"{}}}
\DoxyCodeLine{353                               \textcolor{stringliteral}{"{}occurred with |h| = hmin."{}};}
\DoxyCodeLine{354                 \}}
\DoxyCodeLine{355                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{356             \textcolor{keywordflow}{case} CV\_CONV\_FAILURE:}
\DoxyCodeLine{357                 result = \textcolor{stringliteral}{"{}CV\_CONV\_FAILURE"{}};}
\DoxyCodeLine{358                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{359                     result += \textcolor{stringliteral}{"{}: Convergence test failures occurred too many "{}}}
\DoxyCodeLine{360                               \textcolor{stringliteral}{"{}times (= MXNCF = 10) during one internal time"{}}}
\DoxyCodeLine{361                               \textcolor{stringliteral}{"{}step or occurred with |h| = hmin."{}};}
\DoxyCodeLine{362                 \}}
\DoxyCodeLine{363                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{364             \textcolor{keywordflow}{case} CV\_LINIT\_FAIL:}
\DoxyCodeLine{365                 result = \textcolor{stringliteral}{"{}CV\_LINIT\_FAIL"{}};}
\DoxyCodeLine{366                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{367                     result += \textcolor{stringliteral}{"{}: The linear solver's initialization function "{}}}
\DoxyCodeLine{368                               \textcolor{stringliteral}{"{}failed."{}};}
\DoxyCodeLine{369                 \}}
\DoxyCodeLine{370                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{371             \textcolor{keywordflow}{case} CV\_LSETUP\_FAIL:}
\DoxyCodeLine{372                 result = \textcolor{stringliteral}{"{}CV\_LSETUP\_FAIL"{}};}
\DoxyCodeLine{373                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{374                     result += \textcolor{stringliteral}{"{}: The linear solver's setup routine failed in an "{}}}
\DoxyCodeLine{375                               \textcolor{stringliteral}{"{}unrecoverable manner."{}};}
\DoxyCodeLine{376                 \}}
\DoxyCodeLine{377                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{378             \textcolor{keywordflow}{case} CV\_LSOLVE\_FAIL:}
\DoxyCodeLine{379                 result = \textcolor{stringliteral}{"{}CV\_LSOLVE\_FAIL"{}};}
\DoxyCodeLine{380                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{381                     result += \textcolor{stringliteral}{"{}: The linear solver's solve routine failed in an "{}}}
\DoxyCodeLine{382                               \textcolor{stringliteral}{"{}unrecoverable manner."{}};}
\DoxyCodeLine{383                 \}}
\DoxyCodeLine{384                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{385             \textcolor{keywordflow}{case} CV\_RHSFUNC\_FAIL:}
\DoxyCodeLine{386                 result = \textcolor{stringliteral}{"{}CV\_RHSFUNC\_FAIL"{}};}
\DoxyCodeLine{387                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{388             \textcolor{keywordflow}{case} CV\_FIRST\_RHSFUNC\_ERR:}
\DoxyCodeLine{389                 result = \textcolor{stringliteral}{"{}CV\_FIRST\_RHSFUNC\_ERR"{}};}
\DoxyCodeLine{390                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{391             \textcolor{keywordflow}{case} CV\_REPTD\_RHSFUNC\_ERR:}
\DoxyCodeLine{392                 result = \textcolor{stringliteral}{"{}CV\_REPTD\_RHSFUNC\_ERR"{}};}
\DoxyCodeLine{393                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{394             \textcolor{keywordflow}{case} CV\_UNREC\_RHSFUNC\_ERR:}
\DoxyCodeLine{395                 result = \textcolor{stringliteral}{"{}CV\_UNREC\_RHSFUNC\_ERR"{}};}
\DoxyCodeLine{396                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{397             \textcolor{keywordflow}{case} CV\_RTFUNC\_FAIL:}
\DoxyCodeLine{398                 result = \textcolor{stringliteral}{"{}CV\_RTFUNC\_FAIL"{}};}
\DoxyCodeLine{399                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{400             \textcolor{keywordflow}{case} CV\_MEM\_FAIL:}
\DoxyCodeLine{401                 result = \textcolor{stringliteral}{"{}CV\_MEM\_FAIL"{}};}
\DoxyCodeLine{402                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{403             \textcolor{keywordflow}{case} CV\_MEM\_NULL:}
\DoxyCodeLine{404                 result = \textcolor{stringliteral}{"{}CV\_MEM\_NULL"{}};}
\DoxyCodeLine{405                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{406                     result += \textcolor{stringliteral}{"{}: The cvode\_mem argument was NULL."{}};}
\DoxyCodeLine{407                 \}}
\DoxyCodeLine{408                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{409             \textcolor{keywordflow}{case} CV\_ILL\_INPUT:}
\DoxyCodeLine{410                 result = \textcolor{stringliteral}{"{}CV\_ILL\_INPUT"{}};}
\DoxyCodeLine{411                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{412                     result += \textcolor{stringliteral}{"{}: One of the inputs to CVode is illegal. This "{}}}
\DoxyCodeLine{413                               \textcolor{stringliteral}{"{}includes the situation when a component of the "{}}}
\DoxyCodeLine{414                               \textcolor{stringliteral}{"{}error weight vectors becomes < 0 during "{}}}
\DoxyCodeLine{415                               \textcolor{stringliteral}{"{}internal time-\/stepping.  It also includes the "{}}}
\DoxyCodeLine{416                               \textcolor{stringliteral}{"{}situation where a root of one of the root "{}}}
\DoxyCodeLine{417                               \textcolor{stringliteral}{"{}functions was found both at t0 and very near t0. "{}}}
\DoxyCodeLine{418                               \textcolor{stringliteral}{"{}The ILL\_INPUT flag will also be returned if the "{}}}
\DoxyCodeLine{419                               \textcolor{stringliteral}{"{}linear solver routine CV-\/-\/-\/ (called by the user "{}}}
\DoxyCodeLine{420                               \textcolor{stringliteral}{"{}after calling CVodeCreate) failed to set one of "{}}}
\DoxyCodeLine{421                               \textcolor{stringliteral}{"{}the linear solver-\/related fields in cvode\_mem or "{}}}
\DoxyCodeLine{422                               \textcolor{stringliteral}{"{}if the linear solver's init routine failed. In "{}}}
\DoxyCodeLine{423                               \textcolor{stringliteral}{"{}any case, the user should see the printed "{}}}
\DoxyCodeLine{424                               \textcolor{stringliteral}{"{}error message for more details."{}};}
\DoxyCodeLine{425                 \}}
\DoxyCodeLine{426                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{427             \textcolor{keywordflow}{case} CV\_NO\_MALLOC:}
\DoxyCodeLine{428                 result = \textcolor{stringliteral}{"{}CV\_NO\_MALLOC"{}};}
\DoxyCodeLine{429                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{430                     result += \textcolor{stringliteral}{"{}: indicating that cvode\_mem has not been "{}}}
\DoxyCodeLine{431                               \textcolor{stringliteral}{"{}allocated (i.e., CVodeInit has not been "{}}}
\DoxyCodeLine{432                               \textcolor{stringliteral}{"{}called)."{}};}
\DoxyCodeLine{433                 \}}
\DoxyCodeLine{434                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{435             \textcolor{keywordflow}{case} CV\_BAD\_K:}
\DoxyCodeLine{436                 result = \textcolor{stringliteral}{"{}CV\_BAD\_K"{}};}
\DoxyCodeLine{437                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{438                     result += \textcolor{stringliteral}{"{}: k is not in the range 0, 1, ..., qu."{}};}
\DoxyCodeLine{439                 \}}
\DoxyCodeLine{440                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{441             \textcolor{keywordflow}{case} CV\_BAD\_T:}
\DoxyCodeLine{442                 result = \textcolor{stringliteral}{"{}CV\_BAD\_T"{}};}
\DoxyCodeLine{443                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{444                     result += \textcolor{stringliteral}{"{}: t is not in the interval [tn-\/hu,tn]."{}};}
\DoxyCodeLine{445                 \}}
\DoxyCodeLine{446                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{447             \textcolor{keywordflow}{case} CV\_BAD\_DKY:}
\DoxyCodeLine{448                 result = \textcolor{stringliteral}{"{}CV\_BAD\_DKY"{}};}
\DoxyCodeLine{449                 \textcolor{keywordflow}{if} (exInfo) \{}
\DoxyCodeLine{450                     result += \textcolor{stringliteral}{"{}: The dky argument was NULL."{}};}
\DoxyCodeLine{451                 \}}
\DoxyCodeLine{452                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{453             \textcolor{keywordflow}{case} CV\_TOO\_CLOSE:}
\DoxyCodeLine{454                 result = \textcolor{stringliteral}{"{}CV\_TOO\_CLOSE:"{}};}
\DoxyCodeLine{455                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{456             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{457                 result = \textcolor{stringliteral}{"{}UNKNOWN\_CODE"{}};}
\DoxyCodeLine{458                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{459         \}}
\DoxyCodeLine{460         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{461     \}}
\DoxyCodeLine{462 }
\DoxyCodeLine{463 \}}
\DoxyCodeLine{464 }
\DoxyCodeLine{465 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
