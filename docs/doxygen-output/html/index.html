<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>roadrunner: The LibRoadRunner C++ Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">roadrunner<span id="projectnumber">&#160;2.2.0</span>
   </div>
   <div id="projectbrief">Fast simulator for SBML models</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">The LibRoadRunner C++ Library </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Andy Somogyi (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'y.'+'som'+'og'+'yi@'+'gm'+'ail'+'.c'+'om'; return false;">andy.<span class="obfuscator">.nosp@m.</span>somo<span class="obfuscator">.nosp@m.</span>gyi@g<span class="obfuscator">.nosp@m.</span>mail<span class="obfuscator">.nosp@m.</span>.com</a>, <a href="#" onclick="location.href='mai'+'lto:'+'som'+'og'+'yie'+'@i'+'ndi'+'an'+'a.e'+'du'; return false;">somog<span class="obfuscator">.nosp@m.</span>yie@<span class="obfuscator">.nosp@m.</span>india<span class="obfuscator">.nosp@m.</span>na.e<span class="obfuscator">.nosp@m.</span>du</a>) </dd>
<dd>
Totte Karlsson (<a href="#" onclick="location.href='mai'+'lto:'+'tot'+'te'+'@du'+'ne'+'sci'+'en'+'tif'+'ic'+'.co'+'m'; return false;">totte<span class="obfuscator">.nosp@m.</span>@dun<span class="obfuscator">.nosp@m.</span>escie<span class="obfuscator">.nosp@m.</span>ntif<span class="obfuscator">.nosp@m.</span>ic.co<span class="obfuscator">.nosp@m.</span>m</a>) </dd>
<dd>
Herbert M. Sauro (<a href="#" onclick="location.href='mai'+'lto:'+'hsa'+'ur'+'o@u'+'.w'+'ash'+'in'+'gto'+'n.'+'edu'; return false;">hsaur<span class="obfuscator">.nosp@m.</span>o@u.<span class="obfuscator">.nosp@m.</span>washi<span class="obfuscator">.nosp@m.</span>ngto<span class="obfuscator">.nosp@m.</span>n.edu</a>)</dd></dl>
<h1><a class="anchor" id="sec_intro"></a>
Introduction</h1>
<p >This document describes the application programming interface (wrappers) of <a class="el" href="classrr_1_1RoadRunner.html" title="The main RoadRunner class.">RoadRunner</a>, an open source (BSD) library for computing structural characteristics of cellular networks.</p>
<h1><a class="anchor" id="sec_install"></a>
Instalation</h1>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section user"><dt>Dependencies</dt><dd>The <a class="el" href="classrr_1_1RoadRunner.html" title="The main RoadRunner class.">RoadRunner</a> library depend on several third-party libraries, CLapack, libSBML (libxml2), Sundials, NLEQ, and Poco. These are provided with the binary installation where necessary. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section user"><dt></dt><dd>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</dd></dl>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
</ul>
<ul>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
</ul>
<ul>
<li>Neither the name of University of Washington nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ul>
<dl class="section user"><dt></dt><dd></dd></dl>
<h1><a class="anchor" id="sec_new_integrator"></a>
Creating a new Integrator</h1>
<p >One of the key design goals of the LibRoadRunner library is extensibility. This means that the library is designed with the idea that most internal components are loosely coupled and that it is simple to add new solvers such as new steady state solvers or integrators. This section will give a tutorial on creating a new integrator using the <a class="el" href="classrr_1_1EulerIntegrator.html" title="An example class intended to show how to create an Integrator.">EulerIntegrator</a> as an example.</p>
<p >At its simplest, an <a class="el" href="classrr_1_1Integrator.html">Integrator</a> is a class which implements the <a class="el" href="classrr_1_1Integrator.html">Integrator</a> interface and is responsible for advanding a model (an object which implements the <a class="el" href="classrr_1_1ExecutableModel.html" title="Base class for all code generation systems; allows compiling and evaluating the model.">ExecutableModel</a> interface) forward in time.</p>
<p >All Integrators are created by the <a class="el" href="classrr_1_1IntegratorFactory.html" title="Constructs new integrators.">IntegratorFactory</a> class, this is the only class that knows about the existence of any <a class="el" href="classrr_1_1Integrator.html">Integrator</a> objects. All integrators that the <a class="el" href="classrr_1_1IntegratorFactory.html" title="Constructs new integrators.">IntegratorFactory</a> knows about are automatically available to any code (including any Python code) that needs to create one. Each time the <a class="el" href="classrr_1_1RoadRunner.html#a377834f22edadb7706779ecca7c1eb4e" title="Simulate the current SBML model.">RoadRunner::simulate</a> method is called, a different integrator may be specified. In Python, this is done with the <code>integrator</code> keyword, i.e.</p>
<div class="fragment"><div class="line">r.simulate(0, 10, 100, integrator=<span class="stringliteral">&quot;MyIntegratorName&quot;</span>)</div>
</div><!-- fragment --><p >Or, in C++:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classrr_1_1BasicDictionary.html">BasicDictionary</a> d;</div>
<div class="line">d.<a class="code hl_function" href="classrr_1_1BasicDictionary.html#ae3e2fc27e776cf5c791b4194534d3082">setItem</a>(<span class="stringliteral">&quot;integrator&quot;</span>, <span class="stringliteral">&quot;MyIntegratorName&quot;</span>)</div>
<div class="line">r.simulate(&amp;d);</div>
<div class="ttc" id="aclassrr_1_1BasicDictionary_html"><div class="ttname"><a href="classrr_1_1BasicDictionary.html">rr::BasicDictionary</a></div><div class="ttdoc">This class is frozen, no new features Basic implementation of the Dictionary interface which uses a s...</div><div class="ttdef"><b>Definition:</b> Dictionary.h:140</div></div>
<div class="ttc" id="aclassrr_1_1BasicDictionary_html_ae3e2fc27e776cf5c791b4194534d3082"><div class="ttname"><a href="classrr_1_1BasicDictionary.html#ae3e2fc27e776cf5c791b4194534d3082">rr::BasicDictionary::setItem</a></div><div class="ttdeci">void setItem(const std::string &amp;key, const rr::Setting &amp;value) override</div><div class="ttdoc">sets an item in the internal unordered std::map.</div><div class="ttdef"><b>Definition:</b> Dictionary.cpp:20</div></div>
</div><!-- fragment --><p >To create a new integrator, one first needs to create an object that implments the <a class="el" href="classrr_1_1Integrator.html">Integrator</a> interface, tell <a class="el" href="classrr_1_1RoadRunner.html" title="The main RoadRunner class.">RoadRunner</a> about it.</p>
<h2><a class="anchor" id="sec_int_impl"></a>
Implementing the Integrator interface</h2>
<p >The <a class="el" href="classrr_1_1IntegratorFactory.html" title="Constructs new integrators.">IntegratorFactory</a> is the ONLY object that creates integrators.</p>
<p >Integrators are created when the <a class="el" href="classrr_1_1RegistrationFactory.html#af6a9a68a5895f4da2bf3f57872b09bd4" title="Constructs a new integrator given the name (e.g. cvode, gillespie)">IntegratorFactory::New</a> method is called, typically by the top level <a class="el" href="classrr_1_1RoadRunner.html" title="The main RoadRunner class.">RoadRunner</a> object. New Integrators are given a pointer to an existing <a class="el" href="classrr_1_1ExecutableModel.html" title="Base class for all code generation systems; allows compiling and evaluating the model.">ExecutableModel</a> object which the <a class="el" href="classrr_1_1Integrator.html">Integrator</a> is responsible for advancing forward in time, and pointer to a <a class="el" href="classrr_1_1SimulateOptions.html" title="This class is frozen, no new features RoadRunner simulation options.">SimulateOptions</a> object which contains the initial set of parameters that the <a class="el" href="classrr_1_1Integrator.html">Integrator</a> may configure itself with.</p>
<p >The integrator will hold onto the <a class="el" href="classrr_1_1ExecutableModel.html" title="Base class for all code generation systems; allows compiling and evaluating the model.">ExecutableModel</a> pointer, m, and when the Integrator::integrate method is called, will advance the model object forward in time.</p>
<p >There are three key members of the <a class="el" href="classrr_1_1Integrator.html">Integrator</a> interface that an integrator needs be implement:</p>
<ul>
<li>Integrator::setSimulateOptions This method is called whenever the simulation parameters are changed via calls to the <a class="el" href="classrr_1_1RoadRunner.html#a377834f22edadb7706779ecca7c1eb4e" title="Simulate the current SBML model.">RoadRunner::simulate</a> method, the setSimulateOptions method is called by <a class="el" href="classrr_1_1RoadRunner.html" title="The main RoadRunner class.">RoadRunner</a> object to inform the <a class="el" href="classrr_1_1Integrator.html">Integrator</a> of any new parameter changes. This method should be used to read any updated tuning parameters.</li>
</ul>
<ul>
<li>Integrator::integrate This is the actual method that should perform the time integration.</li>
</ul>
<ul>
<li>Integrator::restart This method is called whenever the <a class="el" href="classrr_1_1RoadRunner.html" title="The main RoadRunner class.">RoadRunner</a> object is re-started. This gives the integrator an option to reload any internal solvers. Simple integrators like the <a class="el" href="classrr_1_1EulerIntegrator.html" title="An example class intended to show how to create an Integrator.">EulerIntegrator</a> does not really do anything in the <a class="el" href="classrr_1_1EulerIntegrator.html#a82a562273e6d73bebcb8e25de45a20a4" title="This simple integrator has nothing to reset, so do nothing here.">EulerIntegrator::restart</a> method, but more sophisticated ones like the CVODE integrator perform a number of tasks such as re-calclating the tollerances and so forth.</li>
</ul>
<p>The other key thing that an <a class="el" href="classrr_1_1Integrator.html">Integrator</a> needs to do is provide a </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_class" href="classrr_1_1Dictionary.html">Dictionary</a>* getIntegratorOptions();</div>
<div class="ttc" id="aclassrr_1_1Dictionary_html"><div class="ttname"><a href="classrr_1_1Dictionary.html">rr::Dictionary</a></div><div class="ttdoc">This class is frozen, no new features A dictionary interface that objects can implement.</div><div class="ttdef"><b>Definition:</b> Dictionary.h:30</div></div>
</div><!-- fragment --><p> method, as in the EulerIntegrator::getIntegratorOptions. This method is used by the <a class="el" href="classrr_1_1IntegratorFactory.html" title="Constructs new integrators.">IntegratorFactory</a> to build a list of all the available tuning parameters that any integrator supports. The returned <a class="el" href="classrr_1_1Dictionary.html" title="This class is frozen, no new features A dictionary interface that objects can implement.">Dictionary</a> pointer should be statically created inside the implemtation file, and should contain the following keys / values</p>
<table class="doxtable">
<tr>
<td>Key </td><td>Value </td></tr>
<tr>
<td>integrator </td><td>The name of your new integrator  </td></tr>
<tr>
<td>integrator.description </td><td>A description of your new integrator  </td></tr>
<tr>
<td>integrator.hint </td><td>A short hint for your new integrator  </td></tr>
</table>
<p >Any additional tuning parameters should be listed in this dictionary, where each tuning parameter should have three key/value pairs.</p>
<table class="doxtable">
<tr>
<td>Key </td><td>Value </td></tr>
<tr>
<td>parameterName </td><td>The default value of this tuning parmeter  </td></tr>
<tr>
<td>parameterName.description </td><td>A description of this tuning parameter  </td></tr>
<tr>
<td>integrator.hint </td><td>A short hint for this tuning parameter  </td></tr>
</table>
<p >When the Integrator::setSimulateOptions method is called, the integrator should read any parameters it expects out of the given dictionary.</p>
<h2><a class="anchor" id="sec_tellrr"></a>
Telling RoadRunner about the new Integrator</h2>
<p >In order for the <a class="el" href="classrr_1_1RoadRunner.html#a377834f22edadb7706779ecca7c1eb4e" title="Simulate the current SBML model.">RoadRunner::simulate</a> method use the new integrator, it needs to know about it. The <a class="el" href="classrr_1_1IntegratorFactory.html" title="Constructs new integrators.">IntegratorFactory</a> is the only object that knows about all the integrators, and a few lines of code need to be added in the implementation of this object so that it can construct one.</p>
<p >First, a new enum value needs to be added to the Integrator::IntegratorId enum. This is numeric index of the integrator. Then the textual name of the integrator needs to be added to the <code>integratorNames</code> static array in the <a class="el" href="Integrator_8cpp.html" title="Contains the base class for RoadRunner integrators.">Integrator.cpp</a> file. Then a line needs to be added inside the <a class="el" href="classrr_1_1RegistrationFactory.html#af6a9a68a5895f4da2bf3f57872b09bd4" title="Constructs a new integrator given the name (e.g. cvode, gillespie)">IntegratorFactory::New</a> method which will create the new integrator, e.g. this is a series of <code>if</code> statements, and a new statment needs to be created which creates an instance of the new kind of integrator:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (opt-&gt;integrator == Integrator::GILLESPIE)</div>
<div class="line">{</div>
<div class="line">    result = <span class="keyword">new</span> <a class="code hl_class" href="classrr_1_1GillespieIntegrator.html">GillespieIntegrator</a>(m, opt);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt-&gt;integrator == Integrator::RK4)</div>
<div class="line">{</div>
<div class="line">    result = <span class="keyword">new</span> RK4Integrator(m, opt);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt-&gt;integrator == Integrator::EULER)</div>
<div class="line">{</div>
<div class="line">    result = <span class="keyword">new</span> EulerIntegrator(m, opt);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    result = <span class="keyword">new</span> CVODEIntegrator(m, opt);</div>
<div class="line">}</div>
<div class="ttc" id="aclassrr_1_1GillespieIntegrator_html"><div class="ttname"><a href="classrr_1_1GillespieIntegrator.html">rr::GillespieIntegrator</a></div><div class="ttdoc">RoadRunner's implementation of the Gillespie SSA.</div><div class="ttdef"><b>Definition:</b> GillespieIntegrator.h:36</div></div>
</div><!-- fragment --><p >Finally, the IntegratorFactory::getIntegratorOptions() method needs to be updated to also return the dictionary that was created in the getIntegratorOptions method, e.g.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <a class="code hl_class" href="classrr_1_1Dictionary.html">Dictionary</a>* options[] = {</div>
<div class="line">        CVODEIntegrator::getIntegratorOptions(),</div>
<div class="line">        GillespieIntegrator::getIntegratorOptions(),</div>
<div class="line">        RK4Integrator::getIntegratorOptions(),</div>
<div class="line">        EulerIntegrator::getIntegratorOptions()</div>
<div class="line">};</div>
</div><!-- fragment --><p >Once the <a class="el" href="classrr_1_1IntegratorFactory.html" title="Constructs new integrators.">IntegratorFactory</a> is made aware of your new integrator, it is available for full introspection and can be used by just adding the <code>integrator="myNewIntegrator"</code> argument whenever the <a class="el" href="classrr_1_1RoadRunner.html#a377834f22edadb7706779ecca7c1eb4e" title="Simulate the current SBML model.">RoadRunner.simulate</a> method is called. The <a class="el" href="classrr_1_1EulerIntegrator.html" title="An example class intended to show how to create an Integrator.">EulerIntegrator</a> was created as an example of how to create and add a new integrator, have a look at it.</p>
<h2><a class="anchor" id="sec_euler"></a>
A complete example of creating an integrator.</h2>
<p >This section includes the complete Euler integrator implemented in <a class="el" href="EulerIntegrator_8h_source.html">EulerIntegrator.h</a> as an example of creating a new integrator. This class has two demo paramters which may be set via the keyword arguments to <a class="el" href="classrr_1_1RoadRunner.html#a377834f22edadb7706779ecca7c1eb4e" title="Simulate the current SBML model.">RoadRunner.simulate</a> in Python, or set via the <a class="el" href="classrr_1_1Dictionary.html#a4708fee12ec4cd5e879df9bf5570c02a" title="Set the value for an arbitrary key.">Dictionary::setItem</a> method on the dictionary that is given to the <a class="el" href="classrr_1_1RoadRunner.html#a377834f22edadb7706779ecca7c1eb4e" title="Simulate the current SBML model.">RoadRunner::simulate</a> method in C++. In Python, this would be:</p>
<div class="fragment"><div class="line">r.simulate(integrator=<span class="stringliteral">&#39;euler&#39;</span>, exampleParameter1=123456, exampleParameter2=<span class="stringliteral">&#39;some value&#39;</span>);</div>
<div class="line">print(r.integrator)</div>
<div class="line"> </div>
<div class="line">&lt; roadrunner.EulerIntegrator() { </div>
<div class="line">  <span class="stringliteral">&#39;this&#39;</span> : 0x101f28350</div>
<div class="line">  <span class="stringliteral">&#39;exampleParameter1&#39;</span> : 123456</div>
<div class="line">  <span class="stringliteral">&#39;exampleParameter2&#39;</span> : some value</div>
<div class="line">}&gt;</div>
</div><!-- fragment --><p >In Python, all the keyword arguments to the simulate method are packaged up and added to the dictionary which is passed into the <a class="el" href="classrr_1_1RoadRunner.html#a377834f22edadb7706779ecca7c1eb4e" title="Simulate the current SBML model.">RoadRunner::simulate</a> method. In C++, the equivalent code would be: </p><div class="fragment"><div class="line"><a class="code hl_class" href="classrr_1_1SimulateOptions.html">SimulateOptions</a>&amp; opt = r.getSimulateOptions();</div>
<div class="line">opt.setItem(<span class="stringliteral">&quot;integrator&quot;</span>, <span class="stringliteral">&quot;euler&quot;</span>)</div>
<div class="line">opt.setItem(<span class="stringliteral">&quot;exampleParameter1&quot;</span>, 123456);</div>
<div class="line">opt.setItem(<span class="stringliteral">&quot;exampleParameter2&quot;</span>, <span class="stringliteral">&quot;some value&quot;</span>);</div>
<div class="line">r.simulate();</div>
<div class="line"> </div>
<div class="line">std::cout &lt;&lt; r.getIntegrator()-&gt;<a class="code hl_function" href="classrr_1_1SimulateOptions.html#af028e3752c6c9c3e25d5ced5c3752b9d">toString</a>() &lt;&lt; std::endl;</div>
<div class="ttc" id="aclassrr_1_1SimulateOptions_html"><div class="ttname"><a href="classrr_1_1SimulateOptions.html">rr::SimulateOptions</a></div><div class="ttdoc">This class is frozen, no new features RoadRunner simulation options.</div><div class="ttdef"><b>Definition:</b> rrRoadRunnerOptions.h:289</div></div>
<div class="ttc" id="aclassrr_1_1SimulateOptions_html_af028e3752c6c9c3e25d5ced5c3752b9d"><div class="ttname"><a href="classrr_1_1SimulateOptions.html#af028e3752c6c9c3e25d5ced5c3752b9d">rr::SimulateOptions::toString</a></div><div class="ttdeci">std::string toString() const</div><div class="ttdoc">get a description of this object, compatable with python str</div><div class="ttdef"><b>Definition:</b> rrRoadRunnerOptions.cpp:156</div></div>
</div><!-- fragment --><p >The <a class="el" href="EulerIntegrator_8h_source.html">EulerIntegrator.h</a> file serves as a complete example of creating an new integrator. This example was written entierly in the header file for clarity, but a real integrator should separate the code and header files. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
